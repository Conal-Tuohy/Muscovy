<?xml-stylesheet href="xsltforms/xsltforms.xsl" type="text/xsl"?>
<?xsltforms-options debug="yes"?>
<?css-conversion no?>
<html 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ev="http://www.w3.org/2001/xml-events" 
	xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<title>Muscovy ODD editor</title>
		<link href="https://fonts.googleapis.com/css?family=Uncial+Antiqua" rel="stylesheet"/>
		<style type="text/css">
               @namespace xf url("http://www.w3.org/2002/xforms");
               body {font-family:  Helvetica, sans-serif}
               h1 {
               	font-size: 32pt;
               	font-family: "Uncial Antiqua", serif;
			font-weight: normal;
               	}
               h2, h3 {
               	font-family: sans-serif;
		}
               div.header {
               	margin-left: auto;
               	margin-right: auto;
               	text-align: center;
		}
               img.logo {
               	width: 4em;
		}
          </style>
		<xf:model>
		
			<!--<xf:instance name="all" src="http://www.tei-c.org/release/xml/tei/custom/odd/tei_all.odd"/>-->
          	
			<!-- track changes to the user's ODD so we can warn them against overwriting it -->
			<xf:instance name="odd-state">
				<state>unmodified</state>
			</xf:instance>

			<!-- the list of external ODD templates -->
			<xf:instance id="templates">
				<ul xml:base="http://www.tei-c.org/release/xml/tei/custom/odd/">
					<li>
						<a href="tei_all.odd">TEI All</a>
					</li>
					<li>
						<a href="tei_lite.odd">TEI Lite</a>
					</li>
				</ul>
			</xf:instance>

			<!-- the user's ODD -->
			<xf:instance id="odd">
				<TEI xmlns="http://www.tei-c.org/ns/1.0" xml:lang="en">
					<teiHeader>
						<fileDesc>
							<titleStmt>
								<title>My TEI Extension</title>
								<author>generated by Muscovy</author>
							</titleStmt>
							<publicationStmt>
								<p>for use by whoever wants it</p>
							</publicationStmt>
							<sourceDesc>
								<p>created using Muscovy</p>
							</sourceDesc>
						</fileDesc>
					</teiHeader>
					<text>
						<front>
							<divGen type="toc"/>
						</front>
						<body>
							<p>My TEI Customization&#xD;
	starts with modules tei, core, textstructure and header</p>
							<schemaSpec ident="myTEI" docLang="en" prefix="tei_" xml:lang="en">
								<moduleRef key="core" except=""/>
								<moduleRef key="tei" except=""/>
								<moduleRef key="header" except=""/>
								<moduleRef key="textstructure" except=""/>
							</schemaSpec>
						</body>
					</text>
				</TEI>
			</xf:instance>
			<xf:instance id="uploaded-odd" xmlns="">
				<ege-webservice-call>
					<fileToConvert xsi:type="xsd:anyURI"/>
				</ege-webservice-call>
			</xf:instance>
			<xf:submission
				id="upload-user-odd" 
				resource="http://www.tei-c.org/ege-webservice/Conversions/TEI%3Atext%3Axml/xml%3Aapplication%3Axml/conversion?properties=%3Cconversions%3E%3Cconversion%20index=%220%22%3E%3Cproperty%20id=%22oxgarage.getImages%22%3Efalse%3C/property%3E%3Cproperty%20id=%22oxgarage.getOnlineImages%22%3Efalse%3C/property%3E%3Cproperty%20id=%22oxgarage.lang%22%3Een%3C/property%3E%3Cproperty%20id=%22oxgarage.textOnly%22%3Efalse%3C/property%3E%3Cproperty%20id=%22pl.psnc.dl.ege.tei.profileNames%22%3Edefault%3C/property%3E%3C/conversion%3E%3C/conversions%3E"
				method="form-data-post" 
				ref="instance('uploaded-odd')"
				replace="instance"
				instance="odd"
				omit-xml-declaration="true"
			>
				<!--
				<xf:header combine="replace">
					<xf:name>Accept</xf:name>
					<xf:value>application/xml, text/xml</xf:value>
				</xf:header>
				-->
			</xf:submission>
			<!--
			<xf:submission
				id="upload-user-odd" 
				resource="http://www.tei-c.org/ege-webservice/Conversions/TEI%3Atext%3Axml/xml%3Aapplication%3Axml/conversion"
				method="post" 
				ref="instance('uploaded-odd')/fileToConvert"
				replace="instance"
				instance="odd"
			/>
			-->
		</xf:model>
	</head>
	<body>
		<div class="header">
			<h1><img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/2/25/Seal-of-Ivan-4_1539_a.svg" alt="Byzantine imperial eagle of Muscovy"/><br/>Muscovy</h1>
			<h2>TEI Schema Editor</h2>
		</div>

		<xf:submit submission="upload-user-odd">
			<xf:label>Upload ODD</xf:label>
		</xf:submit>
				<!--
		<xf:trigger>
			<xf:label>Load</xf:label>
			<xf:action ev:event="DOMActivate">
				<xf:insert origin="instance('source')" nodeset="instance('destination')"/>
			</xf:action>
		</xf:trigger>
				-->
		<!-- removed  mediatype="application/xml" from xf:upload trying to work around Chrome error:
		XMLHttpRequest cannot load http://www.tei-c.org/ege-webservice/Conversions/TEI%3Atext%3Axml/xml%3Aapplication%3Axml/conversion. Request header field Content-Type is not allowed by Access-Control-Allow-Headers in preflight response.
		-->
		<xf:upload ref="instance('uploaded-odd')/fileToConvert" mediatype="application/xml">
			<label>Upload existing ODD</label>
			
		</xf:upload>
	
	</body>
</html>